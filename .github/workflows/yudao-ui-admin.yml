name: yudao-ui-admin-vue2 CI

on:
  workflow_dispatch: # 仅保留手动触发（方便测试）

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    # 1. 拉取yudao-ui-admin-vue2的独立代码仓库
    - name: Checkout yudao-ui-admin-vue2 code
      uses: actions/checkout@v4
      with:
        repository: 11223456789/yudao-ui-admin-vue2 # 子模块对应的独立仓库地址
        ref: master

    # 2. 配置Node.js 14（适配Vue2版本依赖）
    - name: Set up Node.js 14
      uses: actions/setup-node@v4
      with:
        node-version: '14'

    # 3. 配置淘宝npm镜像
    - name: Configure npm mirror
      run: npm config set registry https://registry.npmmirror.com/

    # 4. 安装前端依赖
    - name: Install dependencies
      run: npm install --force --legacy-peer-deps

    # 5. 编译前端项目
    - name: Build frontend project
      run: npm run build:prod

    # 6. 上传编译后的dist包
    - name: Upload dist artifact
      uses: actions/upload-artifact@v4
      with:
        name: yudao-ui-admin-vue2-dist
        path: dist
        if-no-files-found: error
